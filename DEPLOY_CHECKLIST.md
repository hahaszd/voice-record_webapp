# ✅ 生产环境部署检查清单

**部署日期**: ________  
**部署人**: ________  
**版本号**: ________

---

## 📋 部署前检查

### 1️⃣ 代码测试

#### 功能测试（在开发环境）
- [ ] 录音功能正常（麦克风）
- [ ] 录音功能正常（系统音频）
- [ ] 录音功能正常（麦克风+系统音频）
- [ ] 转录功能正常
- [ ] 自动录音功能正常
- [ ] 自动复制功能正常
- [ ] 浏览器通知正常
- [ ] 历史记录功能正常
- [ ] 取消录音功能正常

#### 兼容性测试
- [ ] 桌面端 Chrome（Windows/Mac）
- [ ] 桌面端 Safari（Mac）
- [ ] 桌面端 Edge（Windows）
- [ ] 移动端 iOS Safari（iPhone）
- [ ] 移动端 Android Chrome

#### UI/UX 测试
- [ ] 录音按钮位置居中
- [ ] 转录按钮位置居中（与录音按钮一致）
- [ ] 波形图显示正常（紧贴按钮，无重叠）
- [ ] 取消按钮位置正确（按钮右侧 50px）
- [ ] 移动端无元素重叠
- [ ] 计时器显示正确
- [ ] 自动录音关闭时，转录期间计时显示 00:00

#### 性能测试
- [ ] 页面加载时间 < 2 秒
- [ ] 转录响应时间正常（30s 音频 < 10s）
- [ ] 无内存泄漏（录音 10 次后检查）
- [ ] Console 无错误或警告

---

### 2️⃣ 代码质量

- [ ] 代码已在 dev 分支测试通过
- [ ] 已移除所有 console.log 调试代码（或改为条件输出）
- [ ] 已移除所有 TODO/FIXME 注释（或记录到 issue）
- [ ] 代码符合项目规范（参考 COMMIT_GUIDE.md）
- [ ] 已更新相关文档（README, FEATURES.md 等）

---

### 3️⃣ 环境配置

- [ ] Railway 环境变量配置正确
- [ ] Google Cloud API 凭证有效
- [ ] API 配额充足（检查 Google Cloud Console）
- [ ] 域名配置正确（如有自定义域名）
- [ ] SSL 证书有效

---

### 4️⃣ 备份和回滚准备

- [ ] 已记录当前生产环境版本号/commit hash
- [ ] 已在 Railway 保留上一个稳定部署
- [ ] 知道如何快速回滚（Railway Redeploy）
- [ ] 已通知相关人员即将部署

---

## 🚀 部署步骤

### 步骤 1：合并代码
```bash
git checkout main
git pull origin main
git merge dev
git push origin main
```
- [ ] 代码已合并到 main 分支
- [ ] 无合并冲突

### 步骤 2：触发部署
1. [ ] 访问 Railway Dashboard
2. [ ] 进入 `voicespark-production` 项目
3. [ ] 点击 "Deploy" 按钮
4. [ ] 观察部署日志

### 步骤 3：等待部署完成
- [ ] 部署状态：Success ✅
- [ ] 构建时间：______ 秒
- [ ] 部署日志无错误

---

## 🧪 部署后验证

### 立即测试（部署后 5 分钟内）

#### 基础功能
- [ ] 页面能正常访问
- [ ] 页面加载正常（无白屏）
- [ ] 录音按钮可点击
- [ ] 录音功能正常（测试 10 秒）
- [ ] 转录功能正常

#### 关键修复验证
- [ ] 本次修复的 bug 已解决
- [ ] 未引入新的 bug

#### 性能监控
- [ ] Railway Metrics 显示正常
- [ ] CPU 使用率正常（< 80%）
- [ ] 内存使用正常（< 500MB）

---

### 持续监控（部署后 1 小时内）

- [ ] 每 15 分钟检查一次 Railway Logs
- [ ] 关注是否有错误日志
- [ ] 检查用户反馈（如有反馈渠道）

---

## ⚠️ 回滚决策

### 何时回滚？

立即回滚，如果：
- [ ] 页面无法访问
- [ ] 核心功能（录音/转录）完全无法使用
- [ ] 出现严重的数据丢失或错误
- [ ] 大量用户报告问题

考虑回滚，如果：
- [ ] 次要功能异常
- [ ] UI 显示问题（但不影响功能）
- [ ] 性能下降但仍可用

### 回滚步骤

1. [ ] Railway Dashboard → voicespark-production
2. [ ] Deployments → 选择上一个稳定版本
3. [ ] 点击 "Redeploy"
4. [ ] 确认回滚成功
5. [ ] 通知相关人员
6. [ ] 在 dev 分支修复问题

---

## 📝 部署记录

### 本次部署信息

**Commit Hash**: ________________  
**部署时间**: ____:____ (UTC+8)  
**Railway Build ID**: ________________

### 主要变更
```
1. 
2. 
3. 
```

### 测试结果
```
桌面端: ☐ 通过 ☐ 失败
移动端: ☐ 通过 ☐ 失败
性能: ☐ 正常 ☐ 异常
```

### 遇到的问题
```
问题描述:


解决方案:


```

### 备注
```


```

---

## 🎉 部署完成

- [ ] 所有检查项已完成
- [ ] 部署成功且验证通过
- [ ] 已更新部署记录
- [ ] 已通知相关人员

**签名**: ________________  
**日期**: ________________

---

**下次部署参考**：
- 成功经验：
- 需要改进：
- 注意事项：
